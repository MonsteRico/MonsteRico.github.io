<!DOCTYPE htmL>
<html>
<head>
<style>
</style>
<body>
<canvas id="test1"></canvas>
<canvas id="canvas"></canvas>
<script>
// The size of the tiles in the background
var tileSize = 45;
// The texture 2D containing the level design
var levelMap = new Image();
levelMap.src = './test.jpg';
levelMap.height = 6;
levelMap.setAttribute('crossOrigin', '');
levelMap.width = 11;
console.log(levelMap.height);
console.log(levelMap.width);
// the size of the tiles in the texture with the level design
var levelMapTileSize = 1;
// The X and Y coordinates of the start position for drawing the level.
// public Vector2 StartPoint = new Vector2(144,100);
// Converts image to canvas; returns new canvas element
function Test1() {
    var ctx = document.getElementById('test1');
    if (ctx.getContext) {

        ctx = ctx.getContext('2d');

        //Loading of the home test image - img1
        var img1 = new Image();

        //drawing of the test image - img1
        img1.onload = function () {
            //draw background image
            ctx.drawImage(img1, 0, 0);
            //draw a box over the top
			ctx.fillStyle = "rgba(200, 0, 0, 0.5)";
			ctx.fillRect(0, 0, 500, 500);
        };

        img1.src = levelMap.src;
    }
}
Test1();


function GenerateLevel() {
	for (var x = 0; x < levelMap.width; x+= levelMapTileSize)
	{
	console.log("test");
		for (var y = 0; y < levelMap.height; y+= levelMapTileSize)
		{
			var pixelColor = GetPixel();
			console.log("test");
			console.log(pixelColor);
			//var objectName = GetGameObject(pixelColor);
			//if (objectName == null) { continue;	}

			//var tilePoint = TileToPoint (x, y);	
			//var position = GetWorldPosition (tilePoint);
			//var obj = Resources.Load(objectName, typeof(GameObject));
			//Instantiate(obj, position, Quaternion.identity);
		}
	}
}
GenerateLevel();

function GetPixel() {
    var ctx = document.getElementById('test1');
    if (ctx.getContext) {
		ctx = ctx.getContext('2d');
    }
	var imgData = ctx.getImageData(0, 0, 1000,1000);
	console.log(imgData.data)
	var red = imgData.data[0];
	var green = imgData.data[1];
	var blue = imgData.data[2];
	var alpha = imgData.data[3];
	return red;
}

//private Vector2 TileToPoint(int x, int y) 
//{
	//if (x == 0 && y == 0) {
		//return StartPoint;
	//} 

 // We do this to calculate the position based on our current tileSize and the tile size in the texture level map. 
  // We need that in case we use tiles in the level map of 10x10 for example. 
 //In our case is 1x1 but this is a bit more flexible
	//var posX = x / levelMapTileSize * tileSize;
	//var posY = y / levelMapTileSize * tileSize;

	//var newPoint = StartPoint;
	//newPoint.x += posX;
	//newPoint.y += posY;
	//return newPoint;
//}

//private Vector3 GetWorldPosition(Vector2 point) {
//	var mainCam = Camera.main;
//	var position = mainCam.ScreenToWorldPoint (new Vector3 (point.x, point.y, mainCam.nearClipPlane));
//	return position;
//}

//private string GetGameObject(Color color) {
//	var colorHex = ColorUtility.ToHtmlStringRGB(color);
//	switch (colorHex)
//	{
		//case "087BFE": // blue - player
		//{
//			return "Prefabs/Player";
		//}
		//case "77A841": // green - zombie
		//{
//			return "Prefabs/Zombie";
		//}
		//case "F6EC03": // yellow - sand block
		//{
			//return "Prefabs/SandBlock";
		//}
		//case "737473": // grey - stone block
		//{
//			return "Prefabs/StoneBlock";
		//}
		//case "EA3D00": // red - fire block
		//{
//			return "Prefabs/FireBlock";
		//}
		//default:
//			return null;
//	}	
//}
</script>
</body>
</html>